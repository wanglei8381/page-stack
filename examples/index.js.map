{"version":3,"file":"index.js","sources":["../test/helpers/service.js","../test/helpers/pages.js","../test/helpers/models.js","../src/page-hooks.js","../src/decode.js","../src/utils.js","../src/route.js","../src/page-stack.js","../src/index.js","../test/helpers/index.js"],"sourcesContent":["const lifecycleHooks = [\n  'onLoad',\n  'onReady',\n  'onShow',\n  'onHide',\n  'onUnload'\n]\n\nconst isHook = hook => lifecycleHooks.indexOf(hook) > -1\n\nconst cache = {}\n\nconst noop = () => {}\n\nclass WPage {\n  constructor (options = {}) {\n    this.options = options\n    for (let key in options) {\n      const item = options[key]\n      if (isFunction(item)) {\n        if (!isHook(item)) {\n          this[key] = item\n        } else {\n          options[key] = item.bind(this)\n        }\n      } else if (isPrimitive(item)) {\n        this[key] = item\n      } else {\n        this[key] = JSON.parse(JSON.stringify(item))\n      }\n    }\n\n    for (let i = 0; i < lifecycleHooks.length; i++) {\n      let key = lifecycleHooks[i]\n      if (!options[key]) {\n        options[key] = noop\n      }\n    }\n  }\n\n  setData (data) {}\n\n  onLoad (options) {\n    this.options.onLoad(options)\n  }\n\n  onReady () {\n    this.options.onReady()\n  }\n\n  onShow () {\n    this.options.onShow()\n  }\n\n  onHide () {\n    this.options.onHide()\n  }\n\n  onUnload () {\n    this.options.onUnload()\n    cache[this.router] = null\n  }\n}\n\nfunction isFunction (obj) {\n  return obj != null && typeof obj === 'function'\n}\n\nfunction isPrimitive (value) {\n  return (\n    typeof value === 'string' ||\n    typeof value === 'number' ||\n    typeof value === 'boolean'\n  )\n}\n\nwindow.wxTransformPageKey = {}\n\nwindow.wxTransformGetPage = key => {\n  if (cache[key]) {\n    return cache[key]\n  }\n  const options = window.wxTransformPageKey[key]\n  const page = new WPage(options)\n  page.router = key\n  cache[key] = page\n  return page\n}\n\n// key应该解析页面时获取，这里只是方便测试\nwindow.Page = (key, options) => {\n  window.wxTransformPageKey[key] = options\n}\n","import Vue from 'vue'\n\nVue.component('PageA', {\n  template: '<div class=\"wx-page-container\"><div class=\"page-a\">PageA</div></div>'\n})\n\nVue.component('PageB', {\n  template: '<div class=\"wx-page-container\"><div class=\"page-b\">PageB</div></div>'\n})\n\nVue.component('PageC', {\n  template: '<div class=\"wx-page-container\"><div class=\"page-c\">PageC</div></div>'\n})\n\nVue.component('PageD', {\n  template: '<div class=\"wx-page-container\"><div class=\"page-d\">PageD</div></div>'\n})\n\nVue.component('PageE', {\n  template: '<div class=\"wx-page-container\"><div class=\"page-e\">PageE</div></div>'\n})\n\nVue.component('PageF', {\n  template: '<div class=\"wx-page-container\"><div class=\"page-f\">PageF</div></div>'\n})\n","const PageA = {\n  data: {\n    text: 'PageA'\n  },\n  onLoad (options) {\n    this._unload = false\n    this.params = options\n  },\n  onReady () {\n    this._ready = true\n  },\n  onShow () {\n    this._active = true\n  },\n  onHide () {\n    this._active = false\n  },\n  onUnload () {\n    this._ready = false\n    this._active = false\n    this._unload = true\n  }\n}\n\nconst PageB = Object.assign({}, PageA, {\n  data: {\n    text: 'PageB'\n  }\n})\n\nconst PageC = Object.assign({}, PageA, {\n  data: {\n    text: 'PageC'\n  }\n})\n\nconst PageD = Object.assign({}, PageA, {\n  data: {\n    text: 'PageD'\n  }\n})\n\nconst PageE = Object.assign({}, PageA, {\n  data: {\n    text: 'PageE'\n  }\n})\n\nconst PageF = Object.assign({}, PageA, {\n  data: {\n    text: 'PageF'\n  }\n})\n\nPage('page/a', PageA)\nPage('page/b', PageB)\nPage('page/c', PageC)\nPage('page/d', PageD)\nPage('page/e', PageE)\nPage('page/f', PageF)\n","const getPage = window.wxTransformGetPage\nexport function addPageHook (pageStack, path) {\n  const callPageHook = (hook, options) => {\n    const page = getPage(path)\n    if (page && page['on' + hook]) {\n      page['on' + hook](options)\n    }\n  }\n  return {\n    created () {\n      callPageHook('Load', pageStack.router.params)\n    },\n    beforeMount () {\n      callPageHook('Show')\n    },\n    mounted () {\n      callPageHook('Ready')\n    },\n    destroyed () {\n      callPageHook('Unload')\n    }\n  }\n}\n","/* eslint-disable */\nfunction hasOwnProperty (obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nexport function decode (qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n      idx = x.indexOf(eq),\n      kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (Array.isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n","export const noop = () => {}\n\nexport const inBrowser = typeof window !== 'undefined'\n\nexport const remove = (arr, key) => {\n  if (arr == null || arr.length === 0) return\n  const index = arr.indexOf(key)\n  if (index > -1) {\n    arr.splice(index, 1)\n  }\n}\n","/* global wx */\n/**\n * wx.navigateTo 和 wx.redirectTo 不允许跳转到 tabbar 页面，只能用 wx.switchTab 跳转到 tabbar 页面,\n * 因为小程序自身的约束，这个在page-stack中并没用限制\n */\nimport { decode } from './decode'\nimport {\n  inBrowser,\n  noop\n} from './utils'\n\nexport function initRoute (pageStack, pathMap) {\n  // 保留当前页面，跳转到应用内的某个页面\n  const navigateTo = options => {\n    routeHandler(options, 'navigateTo')\n  }\n\n  // 关闭当前页面，跳转到应用内的某个页面\n  const redirectTo = options => {\n    routeHandler(options, 'redirectTo')\n  }\n\n  // 跳转到 tabBar 页面，并关闭其他所有非 tabBar 页面\n  const switchTab = options => {\n    routeHandler(options, 'switchTab')\n  }\n\n  // 关闭当前页面，返回上一页面或多级页面\n  const navigateBack = options => {\n    pageStack.navigateBack(options || {})\n  }\n\n  // 关闭当前页面，返回上一页面或多级页面\n  const reLaunch = options => {\n    routeHandler(options, 'reLaunch')\n  }\n\n  function routeHandler (options, method) {\n    const { url, success = noop, fail = noop, complete = noop } = options\n    if (url == null) {\n      console.error('url字段为空')\n      return\n    }\n    const urls = url.split('?')\n    const path = urls[0]\n    const page = pathMap[path]\n    if (!page) {\n      console.error('页面切换失败，' + path + '路径不存在')\n      return\n    }\n    const name = page.name\n    if (name === pageStack.router.name) {\n      console.log('同一个页面不需要切换')\n      return\n    }\n    const params = decode(urls[1])\n    pageStack[method]({\n      path,\n      name,\n      params,\n      success,\n      fail,\n      complete\n    })\n  }\n\n  // 挂载到window.wx上\n  if (inBrowser && window.wx) {\n    wx.navigateTo = navigateTo\n    wx.redirectTo = redirectTo\n    wx.switchTab = switchTab\n    wx.navigateBack = navigateBack\n    wx.reLaunch = reLaunch\n  }\n}\n","import { addPageHook } from './page-hooks'\nimport { initRoute } from './route'\nimport { remove } from './utils'\nconst getPage = window.wxTransformGetPage\nexport const pageStack = (Vue, pages) => {\n  // 当前组件的实例\n  let pageStack\n\n  // 进入离开动画的名字\n  const getTransitionName = {\n    1: 'wx-page-open',\n    2: 'wx-page-close'\n  }\n  const transitionData = {\n    name: 'wx-page-open',\n    type: 'transition'\n  }\n  const pathMap = Object.create(null)\n  const nameMap = Object.create(null)\n  pages.forEach((page) => {\n    pathMap[page.path] = page\n    nameMap[page.name] = page\n  })\n\n  // 对已经定义的页面组件进行扩展，添加生命周期钩子函数\n  const expandPageComponent = (vm) => {\n    pages.forEach(({ name, path }) => {\n      const PageComponent = Vue.component(name)\n      const PageExtendComponent = PageComponent.extend(addPageHook(vm, path))\n      Vue.component(name, PageExtendComponent)\n    })\n  }\n\n  function destroyPageComponent (cache, stack, name) {\n    const vnode = cache[name]\n    if (vnode) {\n      vnode.componentInstance.$destroy()\n    }\n    cache[name] = null\n    remove(stack, name)\n  }\n\n  return {\n    name: 'page-stack',\n\n    abstract: true,\n\n    beforeCreate () {\n      if (pageStack) {\n        console.error('page-stack组件只能使用一次，多个挂载点将导致路由混乱')\n      }\n      pageStack = this\n      initRoute(this, pathMap)\n      expandPageComponent(this)\n    },\n\n    created () {\n      this.cache = Object.create(null)\n      const page = pages[0]\n      this.router = {\n        path: page.path,\n        params: {},\n        name: page.name,\n        tabBar: true\n      }\n      this.stack = []\n      // 页面进入离开的类型，1：普通进入，2：返回，3：tab切换\n      this.gotoType = 1\n    },\n\n    destroyed () {\n      this.batchDestroyed(this.stack)\n    },\n\n    methods: {\n      update () {\n        this.$forceUpdate()\n        if (this.cache[this.router.name]) {\n          this.$nextTick(() => {\n            this.callPageHook('Show')\n          })\n        }\n      },\n\n      batchDestroyed (stack) {\n        for (let i = stack.length - 1; i >= 0; i--) {\n          const name = stack[i]\n          destroyPageComponent(this.cache, this.stack, name)\n        }\n      },\n\n      callPageHook (hook = 'Hide') {\n        const page = getPage(this.router.path)\n        if (page && page['on' + hook]) {\n          page['on' + hook]()\n        }\n      },\n\n      navigateTo (options) {\n        this.callPageHook()\n        this.router = options\n        this.gotoType = 1\n        this.update()\n      },\n\n      redirectTo (options) {\n        destroyPageComponent(this.cache, this.stack, this.router.name)\n        this.router = options\n        this.gotoType = 1\n        this.update()\n      },\n\n      switchTab (options) {\n        const stack = this.stack.slice()\n        const tabBars = []\n        const pageNames = []\n        this.stack = []\n        for (let i = 0; i < stack.length; i++) {\n          let name = stack[i]\n          let page = nameMap[name]\n          if (page.tabBar) {\n            tabBars.push(name)\n          } else {\n            pageNames.push(name)\n          }\n        }\n\n        this.batchDestroyed(pageNames)\n        this.stack = tabBars\n        if (this.router.tabBar) {\n          this.callPageHook()\n        }\n        this.gotoType = 3\n        this.router = options\n        this.update()\n      },\n\n      navigateBack (options) {\n        const delta = options.delta || 1\n        const stack = this.stack\n        if (delta >= this.stack.length) {\n          destroyPageComponent(this.cache, this.stack, this.router.name)\n          const page = pages[0]\n          this.router = {\n            path: page.path,\n            params: {},\n            name: page.name,\n            tabBar: true\n          }\n        } else {\n          const length = stack.length - 1\n          const min = length - delta\n          const page = nameMap[stack[min]]\n          for (let i = length; i > min; i--) {\n            const name = stack[i]\n            destroyPageComponent(this.cache, this.stack, name)\n          }\n          this.router = {\n            path: page.path,\n            params: {},\n            name: page.name,\n            tabBar: page.tabBar\n          }\n        }\n\n        this.gotoType = 2\n        this.update()\n      },\n\n      reLaunch (options) {\n        const stack = this.stack.slice()\n        this.stack = []\n        this.batchDestroyed(stack)\n        this.router = options\n        this.gotoType = 1\n        this.update()\n      }\n    },\n\n    render (h) {\n      const cache = this.cache\n      const stack = this.stack\n      const name = this.router.name\n      let vnode = cache[name]\n      if (!vnode) {\n        vnode = cache[name] = h(name)\n        vnode.key = `__transition-${this._uid}-` + name\n        vnode.data.transition = transitionData\n      } else {\n        remove(stack, name)\n      }\n      vnode.data.transition.name = getTransitionName[this.gotoType]\n      stack.push(name)\n      vnode.data.keepAlive = true\n      return vnode\n    }\n  }\n}\n","import { pageStack } from './page-stack'\n\n/*\n pages和option的格式\n\n name是页面组件的名字，path是对应的小程序页面地址，tabBar是在小程序tabBar列表中的页面\n pages: [\n {name: 'PagesIndexIndex', path: 'pages/index/index', tabBar: true},\n {name: 'PagesLogsLogs', path: 'pages/logs/logs'}\n ]\n */\nexport default function (Vue, options) {\n  const pages = options.pages\n  Vue.component('page-stack', pageStack(Vue, pages))\n}\n","import Vue from 'vue'\nimport './service'\nimport './pages'\nimport './models'\nimport pageStack from '../../src/index'\n\nVue.use(pageStack, {\n  pages: [\n    {\n      name: 'PageA',\n      path: 'page/a',\n      tabBar: true\n    },\n    {\n      name: 'PageB',\n      path: 'page/b',\n      tabBar: true\n    },\n    {\n      name: 'PageC',\n      path: 'page/c'\n    },\n    {\n      name: 'PageD',\n      path: 'page/d'\n    },\n    {\n      name: 'PageE',\n      path: 'page/e'\n    },\n    {\n      name: 'PageF',\n      path: 'page/f',\n      tabBar: true\n    }\n  ]\n})\n"],"names":["const","let","this","key","getPage","noop","pageStack","Vue","page"],"mappings":"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"}